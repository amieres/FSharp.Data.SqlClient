      <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Configuration and Input
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SqlCommandProvider provides statically typed access to input parameters and result set of T-SQL command in idiomatic F# way. SqlProgrammabilityProvider exposes Stored Procedures, User-Defined Types and User-Defined Functions in F# code.">
    <meta name="author" content="Dmitry Morozov, Dmitry Sevastianov">

    <script src="//code.jquery.com/jquery-1.8.0.js"></script>
    <script src="//code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet" />

    <link type="text/css" rel="stylesheet" href="./content/style.css" />
    <script type="text/javascript" src="./content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <div class="container">
        <div class="masthead">
            <ul class="nav nav-pills pull-right">
                <li><a href="http://fsharp.org">fsharp.org</a></li>
                <li><a href="http://fsprojects.github.io/">fsprojects</a></li>
                <li><a href="http://github.com/fsprojects/FSharp.Data.SqlClient">github page</a></li>
            </ul>
            <h3 class="muted">FSharp.Data.SqlClient</h3>
        </div>
        <hr />
        <div class="row">
            <div class="span9" id="main">
                
<h1>Configuration and Input</h1>

<h2>SqlCommandProvider parameters</h2>

<table class="table table-bordered table-striped">
<thead><tr><td>Name</td><td>Default</td><td>Accepted values</td></tr></thead>
<tbody>
  <tr><td class="title">CommandText</td><td>-</td><td>T-SQL script or *.sql file</td></tr>
  <tr><td class="title">ConnectionStringOrName</td><td>-</td><td>Connection string or name</td></tr>
  <tr><td class="title">ResultType</td><td>ResultType.Records</td><td>Tuples, Records, DataTable, or DataReader</td></tr>
  <tr><td class="title">SingleRow</td><td>false</td><td>true/false</td></tr>
  <tr><td class="title">ConfigFile</td><td>app.config or web.config</td><td>Valid file name</td></tr>
  <tr><td class="title">AllParametersOptional</td><td>false</td><td>true/false</td></tr>
  <tr><td class="title">ResolutionFolder</td><td>The folder that contains the project or script.</td><td>Valid file system path. Absolute or relative.</td></tr>
  <tr><td class="title">DataDirectory</td><td>The name of the data directory that replaces |DataDirectory| in connection strings. The default value is the project or script directory.</td><td>Valid file system path.</td></tr>
</tbody>
</table>

<h2>SqlProgrammabilityProvider parameters</h2>

<table class="table table-bordered table-striped">
<thead><tr><td>Name</td><td>Default</td><td>Accepted values</td></tr></thead>
<tbody>
  <tr><td class="title">ConnectionStringOrName</td><td>-</td><td>Connection string or name</td></tr>
  <tr><td class="title">ConfigFile</td><td>app.config or web.config</td><td>valid file name</td></tr>
  <tr><td class="title">ResolutionFolder</td><td>The folder that contains the project or script.</td><td>Valid file system path. Absolute or relative.</td></tr>
  <tr><td class="title">DataDirectory</td><td>The name of the data directory that replaces |DataDirectory| in connection strings. The default value is the project or script directory.</td><td>Valid file system path.</td></tr>
  <tr><td class="title">UseReturnValue</td><td>false</td><td>Support for stored procedure return value.</td></tr>
</tbody>
</table>

<h2>CommandText</h2>

<h3>T-SQL script</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Data</span>

[&lt;<span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Literal</span>&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">connStr</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">Data</span><span class="s"> </span><span class="s">Source</span><span class="s">=</span><span class="s">.</span><span class="s">;</span><span class="s">Initial</span><span class="s"> </span><span class="s">Catalog</span><span class="s">=</span><span class="s">AdventureWorks2012</span><span class="s">;</span><span class="s">Integrated</span><span class="s"> </span><span class="s">Security</span><span class="s">=</span><span class="s">True</span><span class="s">&quot;</span>

<span class="c">//Inline T-SQL text convinient for short queries </span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">GetDate</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">GETDATE</span><span class="s">(</span><span class="s">)</span><span class="s"> </span><span class="s">AS</span><span class="s"> </span><span class="s">Now</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="i">connStr</span><span class="o">&gt;</span>

<span class="c">//More complex queries are better off extracted to stand-alone literals</span>

<span class="c">//Fibonacci! Not again! :)</span>
[&lt;<span onmouseout="hideTip(event, 'fs3', 7)" onmouseover="showTip(event, 'fs3', 7)" class="i">Literal</span>&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="i">fibonacci</span> <span class="o">=</span> <span class="s">&quot;</span>
<span class="s">    </span><span class="s">WITH</span><span class="s"> </span><span class="s">Fibonacci</span><span class="s"> </span><span class="s">(</span><span class="s">[</span><span class="s">N</span><span class="s">-</span><span class="s">1</span><span class="s">]</span><span class="s">,</span><span class="s"> </span><span class="s">N</span><span class="s">)</span><span class="s"> </span><span class="s">AS</span>
<span class="s">    </span><span class="s">(</span><span class="s"> </span>
<span class="s">        </span><span class="s">-</span><span class="s">-</span><span class="s">seed</span>
<span class="s">	    </span><span class="s">SELECT</span><span class="s"> </span><span class="s">CAST</span><span class="s">(</span><span class="s">0</span><span class="s"> </span><span class="s">AS</span><span class="s"> </span><span class="s">BIGINT</span><span class="s">)</span><span class="s">,</span><span class="s"> </span><span class="s">CAST</span><span class="s">(</span><span class="s">1</span><span class="s"> </span><span class="s">AS</span><span class="s"> </span><span class="s">BIGINT</span><span class="s">)</span>

<span class="s">	    </span><span class="s">UNION</span><span class="s"> </span><span class="s">ALL</span>
<span class="s">        </span><span class="s">-</span><span class="s">-</span><span class="s">fold</span>
<span class="s">	    </span><span class="s">SELECT</span><span class="s"> </span><span class="s">N</span><span class="s">,</span><span class="s"> </span><span class="s">[</span><span class="s">N</span><span class="s">-</span><span class="s">1</span><span class="s">]</span><span class="s"> </span><span class="s">+</span><span class="s"> </span><span class="s">N</span>
<span class="s">	    </span><span class="s">FROM</span><span class="s"> </span><span class="s">Fibonacci</span>
<span class="s">    </span><span class="s">)</span>

<span class="s">    </span><span class="s">SELECT</span><span class="s"> </span><span class="s">TOP</span><span class="s">(</span><span class="s">@</span><span class="s">Top</span><span class="s">)</span><span class="s"> </span><span class="s">[</span><span class="s">N</span><span class="s">-</span><span class="s">1</span><span class="s">]</span><span class="s"> </span>
<span class="s">    </span><span class="s">FROM</span><span class="s"> </span><span class="s">Fibonacci</span>
<span class="s">&quot;</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="i">FibonacciQuery</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs6', 10)" onmouseover="showTip(event, 'fs6', 10)" class="i">fibonacci</span>, <span onmouseout="hideTip(event, 'fs4', 11)" onmouseover="showTip(event, 'fs4', 11)" class="i">connStr</span><span class="o">&gt;</span>

<span class="k">do</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 12)" onmouseover="showTip(event, 'fs8', 12)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs7', 13)" onmouseover="showTip(event, 'fs7', 13)" class="i">FibonacciQuery</span>(<span onmouseout="hideTip(event, 'fs4', 14)" onmouseover="showTip(event, 'fs4', 14)" class="i">connStr</span>)

    <span onmouseout="hideTip(event, 'fs8', 15)" onmouseover="showTip(event, 'fs8', 15)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>(<span class="n">10L</span>) 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 16)" onmouseover="showTip(event, 'fs9', 16)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="i">map</span> <span onmouseout="hideTip(event, 'fs11', 18)" onmouseover="showTip(event, 'fs11', 18)" class="i">Option</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 19)" onmouseover="showTip(event, 'fs12', 19)" class="i">get</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 20)" onmouseover="showTip(event, 'fs9', 20)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 21)" onmouseover="showTip(event, 'fs13', 21)" class="i">toArray</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">First</span><span class="s"> </span><span class="s">10</span><span class="s"> </span><span class="s">fibonacci</span><span class="s"> </span><span class="s">numbers</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> </pre>
</td>
</tr>
</table>

<h3>External *.sql file</h3>

<p>An ability to use external *.sql file instead of inline strings can improve developement experience.
Visual Studio has rich tooling support for *.sql files. (via SQL Server Data Tools)</p>

<img src="img/sql_file_As_CommandText_1.png"/>

<img src="img/sql_file_As_CommandText_2.png"/>

<p>It offers following benefits:</p>

<ul>
<li>Intellisense in both F# and T-SQL code (it cannot get better)</li>
<li>T-SQL syntax highlighting and verification</li>
<li>Testing: query execution gives immediate feedback (small trick required - see the picture above)</li>
<li>Clean separation between T-SQL and F# code</li>
</ul>

<p>Having all data access layer logic in bunch of files in one location has clear advantage. 
For example, it can be handed over to DBA team for optimization. It's harder to do when application and data access
are mixed together (LINQ).</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 23)" onmouseover="showTip(event, 'fs15', 23)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="k">const</span>(<span class="i">SqlFile</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">GetDate</span><span class="s">.</span><span class="s">sql</span><span class="s">&quot;</span><span class="o">&gt;</span><span class="o">.</span><span class="i">Text</span>), <span onmouseout="hideTip(event, 'fs4', 24)" onmouseover="showTip(event, 'fs4', 24)" class="i">connStr</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs4', 25)" onmouseover="showTip(event, 'fs4', 25)" class="i">connStr</span>)
<span onmouseout="hideTip(event, 'fs15', 26)" onmouseover="showTip(event, 'fs15', 26)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 27)" onmouseover="showTip(event, 'fs16', 27)" class="i">ignore</span></pre>
</td>
</tr>
</table>

<p>Extracting T-SQL into external files is not the only way to scale application development. 
The other alternative is to push logic into programmable objects. 
I strongly recommend T-SQL functions because they have typical benefits of functional-first
programming style: composition (therefore reuse), restricted side-effects and simple substitution model (easy to reason about).
Stored procedures can be used too but they resemble imperative programming with all the drawbacks attached.</p>

<p>Below is an example of SQL Table-Valued Function usage.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs17', 28)" onmouseover="showTip(event, 'fs17', 28)" class="i">GetContactInformation</span> <span class="o">=</span> 
    <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">*</span><span class="s"> </span><span class="s">FROM</span><span class="s"> </span><span class="s">dbo</span><span class="s">.</span><span class="s">ufnGetContactInformation</span><span class="s">(</span><span class="s">@</span><span class="s">PersonId</span><span class="s">)</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs4', 29)" onmouseover="showTip(event, 'fs4', 29)" class="i">connStr</span><span class="o">&gt;</span></pre>
</td>
</tr>
</table>

<h3>Syntax errors</h3>

<p>The type provider shows fairly clear error message if there are any syntax errors in T-SQL. 
An instantaneous feedback is one of the most handy features of <code>SqlCommandProvider</code>.</p>

<h3>Limitation: a single parameter in a query may only be used once.</h3>

<p>For example, an attempt to use following query will fail:</p>

<pre lang="sql"><span class="k">WHEN</span> @x % 3 = 0 <span class="k">AND</span> @x % 5 = 0 <span class="k">THEN</span> &amp;#39;FizzBuzz&amp;#39; 
<span class="k">WHEN</span> @x % 3 = 0 <span class="k">THEN</span> &amp;#39;Fizz&amp;#39; 
<span class="k">WHEN</span> @x % 5 = 0 <span class="k">THEN</span> &amp;#39;Buzz&amp;#39; 
<span class="k">ELSE</span> <span class="k">CAST</span>(@x <span class="k">AS</span> NVARCHAR) </pre>

<p>You can work around this by declaring a local intermediate variable in t-sql script and assigning a parameter in question to that variable.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs18', 30)" onmouseover="showTip(event, 'fs18', 30)" class="i">FizzOrBuzz</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span>
<span class="s">    </span><span class="s">DECLARE</span><span class="s"> </span><span class="s">@</span><span class="s">x</span><span class="s"> </span><span class="s">AS</span><span class="s"> </span><span class="s">INT</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">@</span><span class="s">xVal</span>
<span class="s">    </span><span class="s">SELECT</span><span class="s"> </span>
<span class="s">	    </span><span class="s">CASE</span><span class="s"> </span>
<span class="s">		    </span><span class="s">WHEN</span><span class="s"> </span><span class="s">@</span><span class="s">x</span><span class="s"> </span><span class="s">%</span><span class="s"> </span><span class="s">3</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">0</span><span class="s"> </span><span class="s">AND</span><span class="s"> </span><span class="s">@</span><span class="s">x</span><span class="s"> </span><span class="s">%</span><span class="s"> </span><span class="s">5</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">0</span><span class="s"> </span><span class="s">THEN</span><span class="s"> </span><span class="s">&#39;</span><span class="s">FizzBuzz&#39;</span><span class="s"> </span>
<span class="s">		    </span><span class="s">WHEN</span><span class="s"> </span><span class="s">@</span><span class="s">x</span><span class="s"> </span><span class="s">%</span><span class="s"> </span><span class="s">3</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">0</span><span class="s"> </span><span class="s">THEN</span><span class="s"> </span><span class="s">&#39;</span><span class="s">Fizz&#39;</span><span class="s"> </span>
<span class="s">		    </span><span class="s">WHEN</span><span class="s"> </span><span class="s">@</span><span class="s">x</span><span class="s"> </span><span class="s">%</span><span class="s"> </span><span class="s">5</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">0</span><span class="s"> </span><span class="s">THEN</span><span class="s"> </span><span class="s">&#39;</span><span class="s">Buzz&#39;</span><span class="s"> </span>
<span class="s">		    </span><span class="s">ELSE</span><span class="s"> </span><span class="s">CONCAT</span><span class="s">(</span><span class="s">@</span><span class="s">x</span><span class="s">,</span><span class="s"> </span><span class="s">&#39;</span><span class="s">&#39;</span><span class="s">)</span><span class="s"> </span><span class="s">-</span><span class="s">-</span><span class="s">use</span><span class="s"> </span><span class="s">concat</span><span class="s"> </span><span class="s">to</span><span class="s"> </span><span class="s">avoid</span><span class="s"> </span><span class="s">nullable</span><span class="s"> </span><span class="s">column</span>
<span class="s">	    </span><span class="s">END</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs4', 31)" onmouseover="showTip(event, 'fs4', 31)" class="i">connStr</span><span class="o">&gt;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 32)" onmouseover="showTip(event, 'fs19', 32)" class="i">fizzOrBuzz</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs18', 33)" onmouseover="showTip(event, 'fs18', 33)" class="i">FizzOrBuzz</span>(<span onmouseout="hideTip(event, 'fs4', 34)" onmouseover="showTip(event, 'fs4', 34)" class="i">connStr</span>)
<span onmouseout="hideTip(event, 'fs14', 35)" onmouseover="showTip(event, 'fs14', 35)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Answer</span><span class="s"> </span><span class="s">on</span><span class="s"> </span><span class="s">interview</span><span class="s">:</span><span class="s">\n</span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> [ <span class="k">for</span> <span onmouseout="hideTip(event, 'fs20', 36)" onmouseover="showTip(event, 'fs20', 36)" class="i">i</span> <span class="o">=</span> <span class="n">1</span> <span class="k">to</span> <span class="n">100</span> <span class="k">do</span> <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs19', 37)" onmouseover="showTip(event, 'fs19', 37)" class="i">fizzOrBuzz</span><span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs20', 38)" onmouseover="showTip(event, 'fs20', 38)" class="i">i</span>) ]</pre>
</td>
</tr>
</table>

<h2>ConnectionStringOrName</h2>

<h3>Inline or literal</h3>

<p>Connection string can be provided either via literal (all examples above) or inline</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">//Inline </span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs21', 39)" onmouseover="showTip(event, 'fs21', 39)" class="i">Get42</span> <span class="o">=</span> 
    <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">42</span><span class="s">&quot;</span>, <span class="s">@&quot;</span><span class="s">Data</span><span class="s"> </span><span class="s">Source</span><span class="s">=</span><span class="s">.</span><span class="s">;</span><span class="s">Initial</span><span class="s"> </span><span class="s">Catalog</span><span class="s">=</span><span class="s">AdventureWorks2012</span><span class="s">;</span><span class="s">Integrated</span><span class="s"> </span><span class="s">Security</span><span class="s">=</span><span class="s">True</span><span class="s">&quot;</span><span class="o">&gt;</span></pre>
</td>
</tr>
</table>

<p>The literal version is more practical because connection string definition can be shared between different declarations of <code>SqlCommandProvider&lt;...&gt;</code>.</p>

<h3>By name</h3>

<p>The other option is to supply connection string name from config file.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">//default config file name is app.config or web.config</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs22', 40)" onmouseover="showTip(event, 'fs22', 40)" class="i">Get43</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">43</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">name</span><span class="s">=</span><span class="s">AdventureWorks</span><span class="s">&quot;</span><span class="o">&gt;</span>

<span class="c">//specify ANY other file name (including web.config) explicitly</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs23', 41)" onmouseover="showTip(event, 'fs23', 41)" class="i">Get44</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">44</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">name</span><span class="s">=</span><span class="s">AdventureWorks</span><span class="s">&quot;</span>, <span class="i">ConfigFile</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">user</span><span class="s">.</span><span class="s">config</span><span class="s">&quot;</span><span class="o">&gt;</span></pre>
</td>
</tr>
</table>

<p>I would like to emphasize that <code>ConfigFile</code> is about <em></em><em>design time only</em>. 
Let me give you couple examples to clarify:</p>

<ul>
<li><p>You build Windows Service or WPF application. 
</br></br>
<img src="img/ConnStrByNameAppConfig.png"/>
</br></br>
If it is a purely F# project and default app.config is there <code>ConfigFile</code> parameter can be omitted.
Still, in runtime the connection string with the same name should be available via .NET configuration infrastructure (ConfigurationManager).
It means that either you have packaging/deployment system that knows how to fix connection string in config file to point to
production database (for example, <a href="http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5">Slow Cheetah</a>),
or you do it manually after application is deployed.</p></li>
<li><p>You have mixed ASP.NET WebAPI solution: C# hosting project and F# controllers implementation project.
</br></br>
<img src="img/ConnStrByNameUserConfig.png"/>
</br></br>
F# controllers project is a simple library project. It has data access layer module.
<code>SqlCommandProvider&lt;...&gt;</code> definitions refer to connection string by name form user.config file.
</br></br>
<img src="img/ConnStrByNameUserConfig2.png"/>
</br></br>
It's completely legitimate not to check-in this user.config file into source control system if it's developer specific.
Similar setup can be applied inside single project to separate user-specific configuration from common production config.</p></li>
</ul>

<h3>Overriding connection string at run-time</h3>

<p>Run-time database connectivity configuration is rarely (almost never) the same as design-time. 
All <code>SqlCommandProvider&lt;_&gt;</code>-generated types can be re-configured at run-time via optional constructor parameter.
The parameter is optional because "config file + name" approach is an acceptable way to have run-time configuration different from design-time.
Several use cases are possible:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
<span class="l">49: </span>
<span class="l">50: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">//Case 1: pass run-time connection string into ctor</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 42)" onmouseover="showTip(event, 'fs24', 42)" class="i">runTimeConnStr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">.</span><span class="s">.</span><span class="s">&quot;</span> <span class="c">//somehow get connection string at run-time</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 43)" onmouseover="showTip(event, 'fs25', 43)" class="i">get42</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs21', 44)" onmouseover="showTip(event, 'fs21', 44)" class="i">Get42</span>(<span onmouseout="hideTip(event, 'fs24', 45)" onmouseover="showTip(event, 'fs24', 45)" class="i">runTimeConnStr</span>)

<span class="c">//Case 2: bunch of command types, single database</span>
<span class="c">//Factory or IOC of choice to avoid logic duplication. Use F# ctor static constraints.</span>
<span class="k">module</span> <span class="i">DB</span> <span class="o">=</span> 
    [&lt;<span onmouseout="hideTip(event, 'fs3', 46)" onmouseover="showTip(event, 'fs3', 46)" class="i">Literal</span>&gt;]
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 47)" onmouseover="showTip(event, 'fs26', 47)" class="i">connStr</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">Data</span><span class="s"> </span><span class="s">Source</span><span class="s">=</span><span class="s">.</span><span class="s">;</span><span class="s">Initial</span><span class="s"> </span><span class="s">Catalog</span><span class="s">=</span><span class="s">AdventureWorks2012</span><span class="s">;</span><span class="s">Integrated</span><span class="s"> </span><span class="s">Security</span><span class="s">=</span><span class="s">True</span><span class="s">&quot;</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 49)" onmouseover="showTip(event, 'fs28', 49)" class="i">Data</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 50)" onmouseover="showTip(event, 'fs29', 50)" class="i">SqlClient</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs30', 51)" onmouseover="showTip(event, 'fs30', 51)" class="i">MyCmd1</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">42</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs26', 52)" onmouseover="showTip(event, 'fs26', 52)" class="i">connStr</span><span class="o">&gt;</span>
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs31', 53)" onmouseover="showTip(event, 'fs31', 53)" class="i">MyCmd2</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">42</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs26', 54)" onmouseover="showTip(event, 'fs26', 54)" class="i">connStr</span><span class="o">&gt;</span>

    <span class="k">let</span> <span class="k">inline</span> <span onmouseout="hideTip(event, 'fs32', 55)" onmouseover="showTip(event, 'fs32', 55)" class="i">createCommand</span>() <span class="o">:</span> <span class="o">&#39;</span><span class="i">a</span> <span class="o">=</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 56)" onmouseover="showTip(event, 'fs33', 56)" class="i">runtimeConnStr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">.</span><span class="s">.</span><span class="s">&quot;</span> <span class="c">//somehow get connection string at run-time</span>
        <span class="c">//invoke ctor</span>
        (<span class="o">^</span><span class="i">a</span> <span class="o">:</span> (<span class="k">new</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs34', 57)" onmouseover="showTip(event, 'fs34', 57)" class="i">string</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs35', 58)" onmouseover="showTip(event, 'fs35', 58)" class="i">int</span> <span class="k">-&gt;</span> <span class="o">^</span><span class="i">a</span>) (<span onmouseout="hideTip(event, 'fs33', 59)" onmouseover="showTip(event, 'fs33', 59)" class="i">runtimeConnStr</span>, <span class="n">30</span>)) 
        <span class="c">//or</span>
        <span class="c">//(^a : (static member Create: string -&gt; ^a) runtimeConnStr) </span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 60)" onmouseover="showTip(event, 'fs36', 60)" class="i">dbCmd1</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs37', 61)" onmouseover="showTip(event, 'fs37', 61)" class="i">DB</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 62)" onmouseover="showTip(event, 'fs30', 62)" class="i">MyCmd1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 63)" onmouseover="showTip(event, 'fs37', 63)" class="i">DB</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 64)" onmouseover="showTip(event, 'fs32', 64)" class="i">createCommand</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs38', 65)" onmouseover="showTip(event, 'fs38', 65)" class="i">dbCmd2</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs37', 66)" onmouseover="showTip(event, 'fs37', 66)" class="i">DB</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 67)" onmouseover="showTip(event, 'fs31', 67)" class="i">MyCmd2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 68)" onmouseover="showTip(event, 'fs37', 68)" class="i">DB</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 69)" onmouseover="showTip(event, 'fs32', 69)" class="i">createCommand</span>()

<span class="c">//Case 3: multiple databases</span>
<span class="c">//It gets tricky because we need to distinguish between command types associated with different databases. </span>
<span class="c">//Static type property ConnectionStringOrName that has exactly same value as passed into SqlCommandProvider helps.</span>
<span class="k">module</span> <span class="i">DataAccess</span> <span class="o">=</span> 
    [&lt;<span onmouseout="hideTip(event, 'fs3', 70)" onmouseover="showTip(event, 'fs3', 70)" class="i">Literal</span>&gt;]
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 71)" onmouseover="showTip(event, 'fs39', 71)" class="i">adventureWorks</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">Data</span><span class="s"> </span><span class="s">Source</span><span class="s">=</span><span class="s">.</span><span class="s">;</span><span class="s">Initial</span><span class="s"> </span><span class="s">Catalog</span><span class="s">=</span><span class="s">AdventureWorks2012</span><span class="s">;</span><span class="s">Integrated</span><span class="s"> </span><span class="s">Security</span><span class="s">=</span><span class="s">True</span><span class="s">&quot;</span>
    [&lt;<span onmouseout="hideTip(event, 'fs3', 72)" onmouseover="showTip(event, 'fs3', 72)" class="i">Literal</span>&gt;]
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 73)" onmouseover="showTip(event, 'fs40', 73)" class="i">master</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">Data</span><span class="s"> </span><span class="s">Source</span><span class="s">=</span><span class="s">.</span><span class="s">;</span><span class="s">Initial</span><span class="s"> </span><span class="s">Catalog</span><span class="s">=</span><span class="s">master</span><span class="s">;</span><span class="s">Integrated</span><span class="s"> </span><span class="s">Security</span><span class="s">=</span><span class="s">True</span><span class="s">&quot;</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs41', 74)" onmouseover="showTip(event, 'fs41', 74)" class="i">MyCmd1</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">42</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs39', 75)" onmouseover="showTip(event, 'fs39', 75)" class="i">adventureWorks</span><span class="o">&gt;</span>
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs42', 76)" onmouseover="showTip(event, 'fs42', 76)" class="i">MyCmd2</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">42</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs40', 77)" onmouseover="showTip(event, 'fs40', 77)" class="i">master</span><span class="o">&gt;</span>

    <span class="k">let</span> <span class="k">inline</span> <span onmouseout="hideTip(event, 'fs43', 78)" onmouseover="showTip(event, 'fs43', 78)" class="i">createCommand</span>() <span class="o">:</span> <span class="o">&#39;</span><span class="i">a</span> <span class="o">=</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 79)" onmouseover="showTip(event, 'fs44', 79)" class="i">designTimeConnectionString</span> <span class="o">=</span> (<span class="o">^</span><span class="i">a</span> <span class="o">:</span> (<span class="k">static</span> <span class="k">member</span> <span class="i">get_ConnectionStringOrName</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs45', 80)" onmouseover="showTip(event, 'fs45', 80)" class="i">unit</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs34', 81)" onmouseover="showTip(event, 'fs34', 81)" class="i">string</span>) ())
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 82)" onmouseover="showTip(event, 'fs46', 82)" class="i">connStr</span> <span class="o">=</span> 
            <span class="k">if</span> <span onmouseout="hideTip(event, 'fs44', 83)" onmouseover="showTip(event, 'fs44', 83)" class="i">designTimeConnectionString</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 84)" onmouseover="showTip(event, 'fs39', 84)" class="i">adventureWorks</span>  
            <span class="k">then</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">.</span><span class="s">.</span><span class="s">&quot;</span> <span class="c">//somehow get AdventureWorks connection string at run-time</span>
            <span class="k">elif</span> <span onmouseout="hideTip(event, 'fs44', 85)" onmouseover="showTip(event, 'fs44', 85)" class="i">designTimeConnectionString</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs40', 86)" onmouseover="showTip(event, 'fs40', 86)" class="i">master</span>
            <span class="k">then</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">.</span><span class="s">.</span><span class="s">&quot;</span> <span class="c">//somehow get master connection string at run-time</span>
            <span class="k">else</span> <span onmouseout="hideTip(event, 'fs47', 87)" onmouseover="showTip(event, 'fs47', 87)" class="i">failwith</span> <span class="s">&quot;</span><span class="s">Unexpected</span><span class="s">&quot;</span>
        <span class="c">//invoke ctor</span>
        (<span class="o">^</span><span class="i">a</span> <span class="o">:</span> (<span class="k">new</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs34', 88)" onmouseover="showTip(event, 'fs34', 88)" class="i">string</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs35', 89)" onmouseover="showTip(event, 'fs35', 89)" class="i">int</span> <span class="k">-&gt;</span> <span class="o">^</span><span class="i">a</span>) (<span onmouseout="hideTip(event, 'fs46', 90)" onmouseover="showTip(event, 'fs46', 90)" class="i">connStr</span>, <span class="n">30</span>)) 

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs48', 91)" onmouseover="showTip(event, 'fs48', 91)" class="i">adventureWorksCmd</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs49', 92)" onmouseover="showTip(event, 'fs49', 92)" class="i">DataAccess</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 93)" onmouseover="showTip(event, 'fs41', 93)" class="i">MyCmd1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs49', 94)" onmouseover="showTip(event, 'fs49', 94)" class="i">DataAccess</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 95)" onmouseover="showTip(event, 'fs43', 95)" class="i">createCommand</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 96)" onmouseover="showTip(event, 'fs50', 96)" class="i">masterCmd</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs49', 97)" onmouseover="showTip(event, 'fs49', 97)" class="i">DataAccess</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 98)" onmouseover="showTip(event, 'fs42', 98)" class="i">MyCmd2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs49', 99)" onmouseover="showTip(event, 'fs49', 99)" class="i">DataAccess</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 100)" onmouseover="showTip(event, 'fs43', 100)" class="i">createCommand</span>()</pre>
</td>
</tr>
</table>

<p>Another related case, albeit not that common, is local transaction.</p>

<p><strong>Important:</strong> <code>SqlConnection</code> associated with passed transaction, is not closed automatically in this case. 
It is responsibility of the client code to close and dispose it.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
[&lt;<span onmouseout="hideTip(event, 'fs3', 101)" onmouseover="showTip(event, 'fs3', 101)" class="i">Literal</span>&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 102)" onmouseover="showTip(event, 'fs51', 102)" class="i">bitCoinCode</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">BTC</span><span class="s">&quot;</span>
[&lt;<span onmouseout="hideTip(event, 'fs3', 103)" onmouseover="showTip(event, 'fs3', 103)" class="i">Literal</span>&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 104)" onmouseover="showTip(event, 'fs52', 104)" class="i">bitCoinName</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">Bitcoin</span><span class="s">&quot;</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs53', 105)" onmouseover="showTip(event, 'fs53', 105)" class="i">DeleteBitCoin</span> <span class="o">=</span> 
    <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">DELETE</span><span class="s"> </span><span class="s">FROM</span><span class="s"> </span><span class="s">Sales</span><span class="s">.</span><span class="s">Currency</span><span class="s"> </span><span class="s">WHERE</span><span class="s"> </span><span class="s">CurrencyCode</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">@</span><span class="s">Code</span><span class="s">&quot;</span>
                        , <span onmouseout="hideTip(event, 'fs4', 106)" onmouseover="showTip(event, 'fs4', 106)" class="i">connStr</span><span class="o">&gt;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs54', 107)" onmouseover="showTip(event, 'fs54', 107)" class="i">InsertBitCoin</span> <span class="o">=</span> 
    <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">INSERT</span><span class="s"> </span><span class="s">INTO</span><span class="s"> </span><span class="s">Sales</span><span class="s">.</span><span class="s">Currency</span><span class="s"> </span><span class="s">VALUES</span><span class="s">(</span><span class="s">@</span><span class="s">Code</span><span class="s">,</span><span class="s"> </span><span class="s">@</span><span class="s">Name</span><span class="s">,</span><span class="s"> </span><span class="s">GETDATE</span><span class="s">(</span><span class="s">)</span><span class="s">)</span><span class="s">&quot;</span>
                        , <span onmouseout="hideTip(event, 'fs4', 108)" onmouseover="showTip(event, 'fs4', 108)" class="i">connStr</span><span class="o">&gt;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs55', 109)" onmouseover="showTip(event, 'fs55', 109)" class="i">GetBitCoin</span> <span class="o">=</span> 
    <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">CurrencyCode</span><span class="s">,</span><span class="s"> </span><span class="s">Name</span><span class="s"> </span><span class="s">FROM</span><span class="s"> </span><span class="s">Sales</span><span class="s">.</span><span class="s">Currency</span><span class="s"> </span><span class="s">WHERE</span><span class="s"> </span><span class="s">CurrencyCode</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">@</span><span class="s">code</span><span class="s">&quot;</span>
                        , <span onmouseout="hideTip(event, 'fs4', 110)" onmouseover="showTip(event, 'fs4', 110)" class="i">connStr</span><span class="o">&gt;</span>

<span class="k">do</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs56', 111)" onmouseover="showTip(event, 'fs56', 111)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs53', 112)" onmouseover="showTip(event, 'fs53', 112)" class="i">DeleteBitCoin</span>(<span onmouseout="hideTip(event, 'fs4', 113)" onmouseover="showTip(event, 'fs4', 113)" class="i">connStr</span>) <span class="k">in</span> <span onmouseout="hideTip(event, 'fs56', 114)" onmouseover="showTip(event, 'fs56', 114)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs51', 115)" onmouseover="showTip(event, 'fs51', 115)" class="i">bitCoinCode</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 116)" onmouseover="showTip(event, 'fs16', 116)" class="i">ignore</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs57', 117)" onmouseover="showTip(event, 'fs57', 117)" class="i">conn</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs27', 118)" onmouseover="showTip(event, 'fs27', 118)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 119)" onmouseover="showTip(event, 'fs28', 119)" class="i">Data</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 120)" onmouseover="showTip(event, 'fs29', 120)" class="i">SqlClient</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs58', 121)" onmouseover="showTip(event, 'fs58', 121)" class="i">SqlConnection</span>(<span onmouseout="hideTip(event, 'fs4', 122)" onmouseover="showTip(event, 'fs4', 122)" class="i">connStr</span>)
    <span onmouseout="hideTip(event, 'fs57', 123)" onmouseover="showTip(event, 'fs57', 123)" class="i">conn</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 124)" onmouseover="showTip(event, 'fs59', 124)" class="i">Open</span>()
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs60', 125)" onmouseover="showTip(event, 'fs60', 125)" class="i">tran</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs57', 126)" onmouseover="showTip(event, 'fs57', 126)" class="i">conn</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 127)" onmouseover="showTip(event, 'fs59', 127)" class="i">BeginTransaction</span>()

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs61', 128)" onmouseover="showTip(event, 'fs61', 128)" class="i">cmd</span> <span class="o">=</span> 
        <span class="k">new</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span>
<span class="s">            </span><span class="s">INSERT</span><span class="s"> </span><span class="s">INTO</span><span class="s"> </span><span class="s">Sales</span><span class="s">.</span><span class="s">Currency</span><span class="s"> </span><span class="s">VALUES</span><span class="s">(</span><span class="s">@</span><span class="s">Code</span><span class="s">,</span><span class="s"> </span><span class="s">@</span><span class="s">Name</span><span class="s">,</span><span class="s"> </span><span class="s">GETDATE</span><span class="s">(</span><span class="s">)</span><span class="s">)</span>
<span class="s">        </span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs4', 129)" onmouseover="showTip(event, 'fs4', 129)" class="i">connStr</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs4', 130)" onmouseover="showTip(event, 'fs4', 130)" class="i">connStr</span>)

    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs62', 131)" onmouseover="showTip(event, 'fs62', 131)" class="i">insert</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs54', 132)" onmouseover="showTip(event, 'fs54', 132)" class="i">InsertBitCoin</span><span class="o">.</span><span class="i">Create</span>(<span onmouseout="hideTip(event, 'fs57', 133)" onmouseover="showTip(event, 'fs57', 133)" class="i">conn</span>, <span class="i">transaction</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs60', 134)" onmouseover="showTip(event, 'fs60', 134)" class="i">tran</span>) 
    <span class="k">assert</span>(<span onmouseout="hideTip(event, 'fs62', 135)" onmouseover="showTip(event, 'fs62', 135)" class="i">insert</span><span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs51', 136)" onmouseover="showTip(event, 'fs51', 136)" class="i">bitCoinCode</span>, <span onmouseout="hideTip(event, 'fs52', 137)" onmouseover="showTip(event, 'fs52', 137)" class="i">bitCoinName</span>) <span class="o">=</span> <span class="n">1</span>)

    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs63', 138)" onmouseover="showTip(event, 'fs63', 138)" class="i">get</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs55', 139)" onmouseover="showTip(event, 'fs55', 139)" class="i">GetBitCoin</span>(<span onmouseout="hideTip(event, 'fs57', 140)" onmouseover="showTip(event, 'fs57', 140)" class="i">conn</span>, <span class="i">transaction</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs60', 141)" onmouseover="showTip(event, 'fs60', 141)" class="i">tran</span>)
    <span class="k">assert</span>( <span onmouseout="hideTip(event, 'fs63', 142)" onmouseover="showTip(event, 'fs63', 142)" class="i">get</span><span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs51', 143)" onmouseover="showTip(event, 'fs51', 143)" class="i">bitCoinCode</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 144)" onmouseover="showTip(event, 'fs9', 144)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 145)" onmouseover="showTip(event, 'fs64', 145)" class="i">length</span> <span class="o">=</span> <span class="n">1</span>)

    <span onmouseout="hideTip(event, 'fs60', 146)" onmouseover="showTip(event, 'fs60', 146)" class="i">tran</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs65', 147)" onmouseover="showTip(event, 'fs65', 147)" class="i">Rollback</span>()

    <span class="k">assert</span>( <span onmouseout="hideTip(event, 'fs55', 148)" onmouseover="showTip(event, 'fs55', 148)" class="i">GetBitCoin</span><span class="o">.</span><span class="i">Create</span>(<span onmouseout="hideTip(event, 'fs4', 149)" onmouseover="showTip(event, 'fs4', 149)" class="i">connStr</span>)<span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs51', 150)" onmouseover="showTip(event, 'fs51', 150)" class="i">bitCoinCode</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 151)" onmouseover="showTip(event, 'fs9', 151)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 152)" onmouseover="showTip(event, 'fs64', 152)" class="i">length</span> <span class="o">=</span> <span class="n">0</span>)</pre>
</td>
</tr>
</table>

<p>It is worth noting that because of "erased types" nature of this type provider reflection and other dynamic techniques cannot be used 
to create command instances.</p>

<p><code>SqlProgrammabilityProvider&lt;...&gt;</code> supports connection name syntax as well.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs27', 153)" onmouseover="showTip(event, 'fs27', 153)" class="i">System</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs66', 154)" onmouseover="showTip(event, 'fs66', 154)" class="i">AdventureWorks2012</span> <span class="o">=</span> <span class="i">SqlProgrammabilityProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs4', 155)" onmouseover="showTip(event, 'fs4', 155)" class="i">connStr</span><span class="o">&gt;</span></pre>
</td>
</tr>
</table>

<h3>Optional input parameters</h3>

<p>By default all input parameters of <code>AsyncExecute/Execute</code> generated by <code>SqlCommandProvider&lt;...&gt;</code> are mandatory. 
But there are rare cases when you prefer to handle NULL input values inside T-SQL script. 
<code>AllParametersOptional</code> set to true makes all parameters (guess what) optional.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs67', 156)" onmouseover="showTip(event, 'fs67', 156)" class="i">IncrBy</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">SELECT</span><span class="s"> </span><span class="s">@</span><span class="s">x</span><span class="s"> </span><span class="s">+</span><span class="s"> </span><span class="s">ISNULL</span><span class="s">(</span><span class="s">CAST</span><span class="s">(</span><span class="s">@</span><span class="s">y</span><span class="s"> </span><span class="s">AS</span><span class="s"> </span><span class="s">INT</span><span class="s">)</span><span class="s">,</span><span class="s"> </span><span class="s">1</span><span class="s">)</span><span class="s"> </span><span class="s">&quot;</span>, 
                                    <span onmouseout="hideTip(event, 'fs4', 157)" onmouseover="showTip(event, 'fs4', 157)" class="i">connStr</span>, 
                                    <span class="i">AllParametersOptional</span> <span class="o">=</span> <span class="k">true</span>, 
                                    <span class="i">SingleRow</span> <span class="o">=</span> <span class="k">true</span><span class="o">&gt;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 158)" onmouseover="showTip(event, 'fs68', 158)" class="i">incrBy</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs67', 159)" onmouseover="showTip(event, 'fs67', 159)" class="i">IncrBy</span>(<span onmouseout="hideTip(event, 'fs4', 160)" onmouseover="showTip(event, 'fs4', 160)" class="i">connStr</span>)
<span class="c">//pass both params passed </span>
<span onmouseout="hideTip(event, 'fs68', 161)" onmouseover="showTip(event, 'fs68', 161)" class="i">incrBy</span><span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs69', 162)" onmouseover="showTip(event, 'fs69', 162)" class="i">Some</span> <span class="n">10</span>, <span onmouseout="hideTip(event, 'fs69', 163)" onmouseover="showTip(event, 'fs69', 163)" class="i">Some</span> <span class="n">2</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs69', 164)" onmouseover="showTip(event, 'fs69', 164)" class="i">Some</span>( <span onmouseout="hideTip(event, 'fs69', 165)" onmouseover="showTip(event, 'fs69', 165)" class="i">Some</span> <span class="n">12</span>) <span class="c">//true</span>
<span class="c">//omit second parameter. default to 1</span>
<span onmouseout="hideTip(event, 'fs68', 166)" onmouseover="showTip(event, 'fs68', 166)" class="i">incrBy</span><span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs69', 167)" onmouseover="showTip(event, 'fs69', 167)" class="i">Some</span> <span class="n">10</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs69', 168)" onmouseover="showTip(event, 'fs69', 168)" class="i">Some</span>( <span onmouseout="hideTip(event, 'fs69', 169)" onmouseover="showTip(event, 'fs69', 169)" class="i">Some</span> <span class="n">11</span>) <span class="c">//true</span></pre>
</td>
</tr>
</table>

<p>Note that <code>AllParametersOptional</code> is not supported by <code>SQlProgrammabilityProvider&lt;...&gt;</code> as it is able to 
infer default values for Stored Procedures and UDFs so <code>AsyncExecute</code> signature makes corresponding parameters optional.</p>

<h3>Table-valued parameters (TVPs)</h3>

<p>Sql command needs to call a stored procedure or user-defined function that takes a parameter of table-valued type.</p>

<p>Set up sample type and sproc:</p>

<p><pre>
<code>
CREATE TYPE dbo.myTableType AS TABLE (myId int not null, myName nvarchar(30) null) 
GO 
CREATE PROCEDURE myProc 
   @p1 dbo.myTableType readonly 
AS 
BEGIN 
   SELECT myName from @p1 p 
END 
</code>
</pre></p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs70', 170)" onmouseover="showTip(event, 'fs70', 170)" class="i">TableValuedSample</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span><span class="s">exec</span><span class="s"> </span><span class="s">myProc</span><span class="s"> </span><span class="s">@</span><span class="s">x</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs4', 171)" onmouseover="showTip(event, 'fs4', 171)" class="i">connStr</span><span class="o">&gt;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs71', 172)" onmouseover="showTip(event, 'fs71', 172)" class="i">TVP</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs70', 173)" onmouseover="showTip(event, 'fs70', 173)" class="i">TableValuedSample</span><span class="o">.</span><span class="i">MyTableType</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs72', 174)" onmouseover="showTip(event, 'fs72', 174)" class="i">tvpSp</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs70', 175)" onmouseover="showTip(event, 'fs70', 175)" class="i">TableValuedSample</span>(<span onmouseout="hideTip(event, 'fs4', 176)" onmouseover="showTip(event, 'fs4', 176)" class="i">connStr</span>)
<span class="c">//nullable columns mapped to optional ctor params</span>
<span onmouseout="hideTip(event, 'fs72', 177)" onmouseover="showTip(event, 'fs72', 177)" class="i">tvpSp</span><span class="o">.</span><span class="i">Execute</span>(<span class="i">x</span> <span class="o">=</span> [ <span onmouseout="hideTip(event, 'fs71', 178)" onmouseover="showTip(event, 'fs71', 178)" class="i">TVP</span>(<span class="i">myId</span> <span class="o">=</span> <span class="n">1</span>, <span class="i">myName</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs69', 179)" onmouseover="showTip(event, 'fs69', 179)" class="i">Some</span> <span class="s">&quot;</span><span class="s">monkey</span><span class="s">&quot;</span>); <span onmouseout="hideTip(event, 'fs71', 180)" onmouseover="showTip(event, 'fs71', 180)" class="i">TVP</span>(<span class="i">myId</span> <span class="o">=</span> <span class="n">2</span>) ]) </pre>
</td>
</tr>
</table>

<p>Same with <code>SqlProgrammabilityProvider&lt;...&gt;</code></p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs73', 181)" onmouseover="showTip(event, 'fs73', 181)" class="i">T</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs66', 182)" onmouseover="showTip(event, 'fs66', 182)" class="i">AdventureWorks2012</span><span class="o">.</span><span class="i">dbo</span><span class="o">.</span><span class="i">``User-Defined Table Types``</span><span class="o">.</span><span class="i">MyTableType</span>

<span class="k">do</span> 
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs74', 183)" onmouseover="showTip(event, 'fs74', 183)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs66', 184)" onmouseover="showTip(event, 'fs66', 184)" class="i">AdventureWorks2012</span><span class="o">.</span><span class="i">dbo</span><span class="o">.</span><span class="i">MyProc</span>(<span onmouseout="hideTip(event, 'fs4', 185)" onmouseover="showTip(event, 'fs4', 185)" class="i">connStr</span>)
    <span onmouseout="hideTip(event, 'fs74', 186)" onmouseover="showTip(event, 'fs74', 186)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>([ <span onmouseout="hideTip(event, 'fs73', 187)" onmouseover="showTip(event, 'fs73', 187)" class="i">T</span>(<span class="i">myId</span> <span class="o">=</span> <span class="n">2</span>); <span onmouseout="hideTip(event, 'fs73', 188)" onmouseover="showTip(event, 'fs73', 188)" class="i">T</span>(<span class="i">myId</span> <span class="o">=</span> <span class="n">1</span>) ]) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 189)" onmouseover="showTip(event, 'fs14', 189)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h3>Stored procedures</h3>

<p>Command types generated by <code>SqlProgrammabilityProvider&lt;...&gt;</code> largely have same interface with exceptions: 
There is no static Create factory method because intellisense issue doesnt exist for these types
There is additional ExecuteSingle/ AsyncExecuteSingle to opt-in for singleton result set.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">do</span> 
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs74', 190)" onmouseover="showTip(event, 'fs74', 190)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs66', 191)" onmouseover="showTip(event, 'fs66', 191)" class="i">AdventureWorks2012</span><span class="o">.</span><span class="i">dbo</span><span class="o">.</span><span class="i">uspGetWhereUsedProductID</span>(<span onmouseout="hideTip(event, 'fs4', 192)" onmouseover="showTip(event, 'fs4', 192)" class="i">connStr</span>)

    <span class="c">//sync</span>
    <span onmouseout="hideTip(event, 'fs74', 193)" onmouseover="showTip(event, 'fs74', 193)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>( <span class="i">StartProductID</span> <span class="o">=</span> <span class="n">1</span>, <span class="i">CheckDate</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs75', 194)" onmouseover="showTip(event, 'fs75', 194)" class="i">DateTime</span>(<span class="n">2013</span>,<span class="n">1</span>,<span class="n">1</span>)) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 195)" onmouseover="showTip(event, 'fs14', 195)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span>

    <span class="c">//async</span>
    <span onmouseout="hideTip(event, 'fs74', 196)" onmouseover="showTip(event, 'fs74', 196)" class="i">cmd</span><span class="o">.</span><span class="i">AsyncExecute</span>( <span class="i">StartProductID</span> <span class="o">=</span> <span class="n">1</span>, <span class="i">CheckDate</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs75', 197)" onmouseover="showTip(event, 'fs75', 197)" class="i">DateTime</span>(<span class="n">2013</span>,<span class="n">1</span>,<span class="n">1</span>)) 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs76', 198)" onmouseover="showTip(event, 'fs76', 198)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs77', 199)" onmouseover="showTip(event, 'fs77', 199)" class="i">RunSynchronously</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs78', 200)" onmouseover="showTip(event, 'fs78', 200)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs79', 201)" onmouseover="showTip(event, 'fs79', 201)" class="i">ofSeq</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 202)" onmouseover="showTip(event, 'fs14', 202)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>Stored Procedures output parameters are mapped into F# byref method parameters. 
   Because byref parameters cannot be combined with lazily evaluated computation expression, 
   AsyncExecute and AsyncExecuteSingle methods are not provided.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">do</span> 
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs74', 203)" onmouseover="showTip(event, 'fs74', 203)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs66', 204)" onmouseover="showTip(event, 'fs66', 204)" class="i">AdventureWorks2012</span><span class="o">.</span><span class="i">dbo</span><span class="o">.</span><span class="i">uspLogError</span>(<span onmouseout="hideTip(event, 'fs4', 205)" onmouseover="showTip(event, 'fs4', 205)" class="i">connStr</span>)
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 206)" onmouseover="showTip(event, 'fs80', 206)" class="i">errorLogId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs81', 207)" onmouseover="showTip(event, 'fs81', 207)" class="i">ref</span> <span class="o">-</span><span class="n">1</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs82', 208)" onmouseover="showTip(event, 'fs82', 208)" class="i">recordsAffected</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 209)" onmouseover="showTip(event, 'fs74', 209)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>(<span onmouseout="hideTip(event, 'fs80', 210)" onmouseover="showTip(event, 'fs80', 210)" class="i">errorLogId</span>)
    <span onmouseout="hideTip(event, 'fs14', 211)" onmouseover="showTip(event, 'fs14', 211)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">errorLogId</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">i</span><span class="s">&quot;</span> <span class="o">!</span><span onmouseout="hideTip(event, 'fs80', 212)" onmouseover="showTip(event, 'fs80', 212)" class="i">errorLogId</span>

<span class="k">do</span>  <span class="c">//tupled invocation syntax</span>
    <span class="c">//works only in VS 2015 or later because of F# compiler bug</span>
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs74', 213)" onmouseover="showTip(event, 'fs74', 213)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs66', 214)" onmouseover="showTip(event, 'fs66', 214)" class="i">AdventureWorks2012</span><span class="o">.</span><span class="i">dbo</span><span class="o">.</span><span class="i">uspLogError</span>(<span onmouseout="hideTip(event, 'fs4', 215)" onmouseover="showTip(event, 'fs4', 215)" class="i">connStr</span>)
    <span class="k">let</span> _, <span onmouseout="hideTip(event, 'fs83', 216)" onmouseover="showTip(event, 'fs83', 216)" class="i">errorLogId</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 217)" onmouseover="showTip(event, 'fs74', 217)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>()
    <span onmouseout="hideTip(event, 'fs14', 218)" onmouseover="showTip(event, 'fs14', 218)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">errorLogId</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">i</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs83', 219)" onmouseover="showTip(event, 'fs83', 219)" class="i">errorLogId</span>

<span class="k">do</span>  <span class="c">//mutable bindgings </span>
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs74', 220)" onmouseover="showTip(event, 'fs74', 220)" class="i">cmd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs66', 221)" onmouseover="showTip(event, 'fs66', 221)" class="i">AdventureWorks2012</span><span class="o">.</span><span class="i">dbo</span><span class="o">.</span><span class="i">uspLogError</span>(<span onmouseout="hideTip(event, 'fs4', 222)" onmouseover="showTip(event, 'fs4', 222)" class="i">connStr</span>)
    <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs84', 223)" onmouseover="showTip(event, 'fs84', 223)" class="i">errorLogId</span> <span class="o">=</span> <span class="o">-</span><span class="n">1</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs82', 224)" onmouseover="showTip(event, 'fs82', 224)" class="i">recordsAffected</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 225)" onmouseover="showTip(event, 'fs74', 225)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>(<span class="o">&amp;</span><span onmouseout="hideTip(event, 'fs84', 226)" onmouseover="showTip(event, 'fs84', 226)" class="i">errorLogId</span>)
    <span onmouseout="hideTip(event, 'fs14', 227)" onmouseover="showTip(event, 'fs14', 227)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">errorLogId</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">i</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs84', 228)" onmouseover="showTip(event, 'fs84', 228)" class="i">errorLogId</span></pre>
</td>
</tr>
</table>

<p>By default stored procedure return values are not surfaced. 
To make it available specify UseReturnValue = true static parameter of SqlProgrammabilityProvider. 
RETURN_VALUE will be the last byref parameter.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">do</span> 
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs74', 229)" onmouseover="showTip(event, 'fs74', 229)" class="i">cmd</span> <span class="o">=</span> 
        <span class="k">new</span> <span class="i">SqlProgrammabilityProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs4', 230)" onmouseover="showTip(event, 'fs4', 230)" class="i">connStr</span>, <span class="i">UseReturnValue</span> <span class="o">=</span> <span class="k">true</span><span class="o">&gt;</span><span class="o">.</span><span class="i">dbo</span><span class="o">.</span><span class="i">uspLogError</span>(<span onmouseout="hideTip(event, 'fs4', 231)" onmouseover="showTip(event, 'fs4', 231)" class="i">connStr</span>)
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs85', 232)" onmouseover="showTip(event, 'fs85', 232)" class="i">recordsAffected</span>, <span onmouseout="hideTip(event, 'fs83', 233)" onmouseover="showTip(event, 'fs83', 233)" class="i">errorLogId</span>, <span onmouseout="hideTip(event, 'fs86', 234)" onmouseover="showTip(event, 'fs86', 234)" class="i">returnValue</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 235)" onmouseover="showTip(event, 'fs74', 235)" class="i">cmd</span><span class="o">.</span><span class="i">Execute</span>()
    <span onmouseout="hideTip(event, 'fs14', 236)" onmouseover="showTip(event, 'fs14', 236)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">recordsAffected</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">i</span><span class="s">,</span><span class="s"> </span><span class="s">errorLogId</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">i</span><span class="s">,</span><span class="s"> </span><span class="s">returnValue</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">i</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs85', 237)" onmouseover="showTip(event, 'fs85', 237)" class="i">recordsAffected</span> <span onmouseout="hideTip(event, 'fs83', 238)" onmouseover="showTip(event, 'fs83', 238)" class="i">errorLogId</span> <span onmouseout="hideTip(event, 'fs86', 239)" onmouseover="showTip(event, 'fs86', 239)" class="i">returnValue</span></pre>
</td>
</tr>
</table>

<p>Things get interesting when stored procedure return both set of rows and output parameters. 
I won't show any sample code because AdventureWorks database doesn't have such procedure. 
But the only change comparing to non-query stored procedure that instead of returning number 
of affected records it returns F# list of records. 
Notice that list is data structure as oppose to lazy evaluated seq<_> computation. 
This caused by a fact Sql Server + ADO.NET populates output parameter only after row set reader is closed. 
See [http://stackoverflow.com/questions/65662/output-parameters-not-readable-when-used-with-a-datareader].</p>

<div class="tip" id="fs1">namespace FSharp</div>
<div class="tip" id="fs2">namespace FSharp.Data</div>
<div class="tip" id="fs3">Multiple items<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />Full name: Microsoft.FSharp.Core.LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs4">val connStr : string<br /><br />Full name: Configuration and Input.connStr</div>
<div class="tip" id="fs5">type GetDate = obj<br /><br />Full name: Configuration and Input.GetDate</div>
<div class="tip" id="fs6">val fibonacci : string<br /><br />Full name: Configuration and Input.fibonacci</div>
<div class="tip" id="fs7">type FibonacciQuery = obj<br /><br />Full name: Configuration and Input.FibonacciQuery</div>
<div class="tip" id="fs8">val cmd : FibonacciQuery</div>
<div class="tip" id="fs9">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs10">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs11">module Option<br /><br />from Microsoft.FSharp.Core</div>
<div class="tip" id="fs12">val get : option:&#39;T option -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Option.get</div>
<div class="tip" id="fs13">val toArray : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs14">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs15">val cmd : obj<br /><br />Full name: Configuration and Input.cmd</div>
<div class="tip" id="fs16">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>
<div class="tip" id="fs17">type GetContactInformation = obj<br /><br />Full name: Configuration and Input.GetContactInformation</div>
<div class="tip" id="fs18">type FizzOrBuzz = obj<br /><br />Full name: Configuration and Input.FizzOrBuzz</div>
<div class="tip" id="fs19">val fizzOrBuzz : FizzOrBuzz<br /><br />Full name: Configuration and Input.fizzOrBuzz</div>
<div class="tip" id="fs20">val i : int</div>
<div class="tip" id="fs21">type Get42 = obj<br /><br />Full name: Configuration and Input.Get42</div>
<div class="tip" id="fs22">type Get43 = obj<br /><br />Full name: Configuration and Input.Get43</div>
<div class="tip" id="fs23">type Get44 = obj<br /><br />Full name: Configuration and Input.Get44</div>
<div class="tip" id="fs24">val runTimeConnStr : string<br /><br />Full name: Configuration and Input.runTimeConnStr</div>
<div class="tip" id="fs25">val get42 : Get42<br /><br />Full name: Configuration and Input.get42</div>
<div class="tip" id="fs26">val connStr : string<br /><br />Full name: Configuration and Input.DB.connStr</div>
<div class="tip" id="fs27">namespace System</div>
<div class="tip" id="fs28">namespace System.Data</div>
<div class="tip" id="fs29">namespace System.Data.SqlClient</div>
<div class="tip" id="fs30">type MyCmd1 = obj<br /><br />Full name: Configuration and Input.DB.MyCmd1</div>
<div class="tip" id="fs31">type MyCmd2 = obj<br /><br />Full name: Configuration and Input.DB.MyCmd2</div>
<div class="tip" id="fs32">val createCommand : unit -&gt; &#39;a (requires member ( .ctor ))<br /><br />Full name: Configuration and Input.DB.createCommand</div>
<div class="tip" id="fs33">val runtimeConnStr : string</div>
<div class="tip" id="fs34">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs35">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs36">val dbCmd1 : DB.MyCmd1<br /><br />Full name: Configuration and Input.dbCmd1</div>
<div class="tip" id="fs37">module DB<br /><br />from Configuration and Input</div>
<div class="tip" id="fs38">val dbCmd2 : DB.MyCmd2<br /><br />Full name: Configuration and Input.dbCmd2</div>
<div class="tip" id="fs39">val adventureWorks : string<br /><br />Full name: Configuration and Input.DataAccess.adventureWorks</div>
<div class="tip" id="fs40">val master : string<br /><br />Full name: Configuration and Input.DataAccess.master</div>
<div class="tip" id="fs41">type MyCmd1 = obj<br /><br />Full name: Configuration and Input.DataAccess.MyCmd1</div>
<div class="tip" id="fs42">type MyCmd2 = obj<br /><br />Full name: Configuration and Input.DataAccess.MyCmd2</div>
<div class="tip" id="fs43">val createCommand : unit -&gt; &#39;a (requires member get_ConnectionStringOrName and member ( .ctor ))<br /><br />Full name: Configuration and Input.DataAccess.createCommand</div>
<div class="tip" id="fs44">val designTimeConnectionString : string</div>
<div class="tip" id="fs45">type unit = Unit<br /><br />Full name: Microsoft.FSharp.Core.unit</div>
<div class="tip" id="fs46">val connStr : string</div>
<div class="tip" id="fs47">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs48">val adventureWorksCmd : DataAccess.MyCmd1<br /><br />Full name: Configuration and Input.adventureWorksCmd</div>
<div class="tip" id="fs49">module DataAccess<br /><br />from Configuration and Input</div>
<div class="tip" id="fs50">val masterCmd : DataAccess.MyCmd2<br /><br />Full name: Configuration and Input.masterCmd</div>
<div class="tip" id="fs51">val bitCoinCode : string<br /><br />Full name: Configuration and Input.bitCoinCode</div>
<div class="tip" id="fs52">val bitCoinName : string<br /><br />Full name: Configuration and Input.bitCoinName</div>
<div class="tip" id="fs53">type DeleteBitCoin = obj<br /><br />Full name: Configuration and Input.DeleteBitCoin</div>
<div class="tip" id="fs54">type InsertBitCoin = obj<br /><br />Full name: Configuration and Input.InsertBitCoin</div>
<div class="tip" id="fs55">type GetBitCoin = obj<br /><br />Full name: Configuration and Input.GetBitCoin</div>
<div class="tip" id="fs56">val cmd : DeleteBitCoin</div>
<div class="tip" id="fs57">val conn : System.Data.SqlClient.SqlConnection</div>
<div class="tip" id="fs58">Multiple items<br />type SqlConnection =<br />&#160;&#160;inherit DbConnection<br />&#160;&#160;new : unit -&gt; SqlConnection + 1 overload<br />&#160;&#160;member BeginTransaction : unit -&gt; SqlTransaction + 3 overloads<br />&#160;&#160;member ChangeDatabase : database:string -&gt; unit<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member ConnectionString : string with get, set<br />&#160;&#160;member ConnectionTimeout : int<br />&#160;&#160;member CreateCommand : unit -&gt; SqlCommand<br />&#160;&#160;member DataSource : string<br />&#160;&#160;member Database : string<br />&#160;&#160;member EnlistDistributedTransaction : transaction:ITransaction -&gt; unit<br />&#160;&#160;...<br /><br />Full name: System.Data.SqlClient.SqlConnection<br /><br />--------------------<br />System.Data.SqlClient.SqlConnection() : unit<br />System.Data.SqlClient.SqlConnection(connectionString: string) : unit</div>
<div class="tip" id="fs59"></div>
<div class="tip" id="fs60">val tran : System.Data.SqlClient.SqlTransaction</div>
<div class="tip" id="fs61">val cmd : obj</div>
<div class="tip" id="fs62">val insert : System.IDisposable</div>
<div class="tip" id="fs63">val get : GetBitCoin</div>
<div class="tip" id="fs64">val length : source:seq&lt;&#39;T&gt; -&gt; int<br /><br />Full name: Microsoft.FSharp.Collections.Seq.length</div>
<div class="tip" id="fs65">System.Data.SqlClient.SqlTransaction.Rollback() : unit<br />System.Data.SqlClient.SqlTransaction.Rollback(transactionName: string) : unit</div>
<div class="tip" id="fs66">type AdventureWorks2012 = obj<br /><br />Full name: Configuration and Input.AdventureWorks2012</div>
<div class="tip" id="fs67">type IncrBy = obj<br /><br />Full name: Configuration and Input.IncrBy</div>
<div class="tip" id="fs68">val incrBy : IncrBy<br /><br />Full name: Configuration and Input.incrBy</div>
<div class="tip" id="fs69">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs70">type TableValuedSample = obj<br /><br />Full name: Configuration and Input.TableValuedSample</div>
<div class="tip" id="fs71">type TVP = obj<br /><br />Full name: Configuration and Input.TVP</div>
<div class="tip" id="fs72">val tvpSp : TableValuedSample<br /><br />Full name: Configuration and Input.tvpSp</div>
<div class="tip" id="fs73">type T = obj<br /><br />Full name: Configuration and Input.T</div>
<div class="tip" id="fs74">val cmd : IDisposable</div>
<div class="tip" id="fs75">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs76">Multiple items<br />type Async<br />static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member CancelDefaultToken : unit -&gt; unit<br />static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg:&#39;Arg1 * beginAction:(&#39;Arg1 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * beginAction:(&#39;Arg1 * &#39;Arg2 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * arg3:&#39;Arg3 * beginAction:(&#39;Arg1 * &#39;Arg2 * &#39;Arg3 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromContinuations : callback:((&#39;T -&gt; unit) * (exn -&gt; unit) * (OperationCanceledException -&gt; unit) -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member Ignore : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br />static member OnCancel : interruption:(unit -&gt; unit) -&gt; Async&lt;IDisposable&gt;<br />static member Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;<br />static member RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T<br />static member Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;<br />static member Start : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions * ?cancellationToken:CancellationToken -&gt; Task&lt;&#39;T&gt;<br />static member StartChild : computation:Async&lt;&#39;T&gt; * ?millisecondsTimeout:int -&gt; Async&lt;Async&lt;&#39;T&gt;&gt;<br />static member StartChildAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions -&gt; Async&lt;Task&lt;&#39;T&gt;&gt;<br />static member StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartWithContinuations : computation:Async&lt;&#39;T&gt; * continuation:(&#39;T -&gt; unit) * exceptionContinuation:(exn -&gt; unit) * cancellationContinuation:(OperationCanceledException -&gt; unit) * ?cancellationToken:CancellationToken -&gt; unit<br />static member SwitchToContext : syncContext:SynchronizationContext -&gt; Async&lt;unit&gt;<br />static member SwitchToNewThread : unit -&gt; Async&lt;unit&gt;<br />static member SwitchToThreadPool : unit -&gt; Async&lt;unit&gt;<br />static member TryCancelled : computation:Async&lt;&#39;T&gt; * compensation:(OperationCanceledException -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member CancellationToken : Async&lt;CancellationToken&gt;<br />static member DefaultCancellationToken : CancellationToken<br /><br />Full name: Microsoft.FSharp.Control.Async<br /><br />--------------------<br />type Async&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Async&lt;_&gt;</div>
<div class="tip" id="fs77">static member Async.RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:Threading.CancellationToken -&gt; &#39;T</div>
<div class="tip" id="fs78">type Array =<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CopyTo : array:Array * index:int -&gt; unit + 1 overload<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator<br />&#160;&#160;member GetLength : dimension:int -&gt; int<br />&#160;&#160;member GetLongLength : dimension:int -&gt; int64<br />&#160;&#160;member GetLowerBound : dimension:int -&gt; int<br />&#160;&#160;member GetUpperBound : dimension:int -&gt; int<br />&#160;&#160;member GetValue : params indices:int[] -&gt; obj + 7 overloads<br />&#160;&#160;member Initialize : unit -&gt; unit<br />&#160;&#160;member IsFixedSize : bool<br />&#160;&#160;...<br /><br />Full name: System.Array</div>
<div class="tip" id="fs79">val ofSeq : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.ofSeq</div>
<div class="tip" id="fs80">val errorLogId : int ref</div>
<div class="tip" id="fs81">Multiple items<br />val ref : value:&#39;T -&gt; &#39;T ref<br /><br />Full name: Microsoft.FSharp.Core.Operators.ref<br /><br />--------------------<br />type &#39;T ref = Ref&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.ref&lt;_&gt;</div>
<div class="tip" id="fs82">val recordsAffected : obj</div>
<div class="tip" id="fs83">val errorLogId : int</div>
<div class="tip" id="fs84">val mutable errorLogId : int</div>
<div class="tip" id="fs85">val recordsAffected : int</div>
<div class="tip" id="fs86">val returnValue : int</div>

            </div>

            <div class="span3">
                <a href="http://www.nuget.org/packages/FSharp.Data.SqlClient">
                    <img src="img/logo.png" style="width: 200px; height: 200px; margin: 10px 0px 0px 35px; border-style: none;" />
                </a>
                <ul class="nav nav-list" id="menu">
                    <li class="nav-header">F# SqlClient</li>
                    <li><a href="./index.html">Home page</a></li>
                    <li class="divider"></li>
                    <li><a href="http://www.nuget.org/packages/FSharp.Data.SqlClient">Get Library via NuGet</a></li>
                    <li><a href="http://github.com/fsprojects/FSharp.Data.SqlClient">Source Code on GitHub</a></li>
                    <li><a href="http://github.com/fsprojects/FSharp.Data.SqlClient/blob/master/LICENSE.md">License</a></li>
                    <li><a href="http://github.com/fsprojects/FSharp.Data.SqlClient/blob/master/RELEASE_NOTES.md">Release Notes</a></li>

                    <li class="nav-header">Documentation</li>
                    <li><a href="./whatsnew.html">What's New</a></li>
                    <li><a href="./netcore.html">Support for .NET Core</a></li>
                    <li><a href="./configuration and input.html">Configuration and Input</a></li>
                    <li><a href="./output.html">Output</a></li>                    
                    <li><a href="./faq.html">FAQ</a></li>
                    <li class="divider"></li>
                    <li><a href="./data modification.html">Data Modification</a></li>
                    <li><a href="./transactions.html">Transactions</a></li>
                    <li class="divider"></li>
                    <li><a href="./debugging.html">Debugging</a></li>
                    <li><a href="./unit-testing.html">Unit Testing</a></li>
                    <li class="divider"></li>
                    <li><a href="./comparison.html">Comparison</a></li>
                    <li><a href="./dynamic local db.html">Dynamic local db</a></li>
                    <li class="divider"></li>
                    <li><a href="./sqlenumprovider.quickstart.html">SqlEnumProvider</a></li>

                    <li class="nav-header">Tools</li>
                    <li><a href="http://tpetricek.github.io/FSharp.Formatting/">F# Formatting</a></li>
                    <li><a href="http://fsharp.github.io/FAKE/">FAKE</a></li>
                    <li><a href="http://fsprojects.github.io/ProjectScaffold/">F# open-source project scaffolding</a></li>
                    <li><a href="http://tomasp.net/blog/2013/great-open-source/index.html">Building great open-source libraries</a></li>
                </ul>
            </div>
        </div>
    </div>
    <a href="http://github.com/fsprojects/FSharp.Data.SqlClient">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub">
    </a>
</body>
</html>
